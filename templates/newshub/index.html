{% extends 'newshub/framework/base.html' %}
{% load staticfiles %}
{% comment %}
    This is the main entry for the website, here will be the feed of articles.

    Data received
    ------
    articles: a list of articles, generated by the back-end.
        - article: a single article 
            - author: the user object of the article, ie. who created it
            - title
            - headline
            - content
            - tags: a list of tags
                -tag
                    - name: the name of the tag such as 'football'
                    - category: the category object. Each tag has one category, but a signle category can have many tags. Example would be 'Sport'
                        - name: the name of the category
            - time_uploaded: a datetime object of when was the article first uploaded
            - time_changed: the time of the last save of the article
{% endcomment %}
{% block content %}
<div class="row fill-height">
    <div class="col-sm-2 left-sidebar">
        {% include 'newshub/framework/left-sidebar.html' with article=False type=type %}
    </div><!-- /.article-sidebar -->

    <div class="col-sm-8 center-block main">
        
        {% for article in articles %}
        <div class="row">
            <div class="center-block feed-article">
                <a class="article-link" href="{% url 'newshub:view_article' action_type=type pk=article.pk %}">
                    <h1 class="article-post-title">{{article.title}}</h1>
                    <p class="article-post-headline">{{article.headline}}</p>
                </a>
                {% if request.user != article.author.user %}
                <div class="post-tools" data-author-id="{{article.author.id}}">
                    <p class="article-post-meta"><img src="{{article.author.user.profile.picture.url}}" alt="author pic"/><a href="{% url 'newshub:profile' article.author.user.pk %}">{{article.author.user.first_name}} {{article.author.user.last_name}}</a></p>
                    {% if request.user in article.author.followed_by.all %}
                    <button type="button" class="btn btn-active btn-default follow-button">
                        Followed
                    {% else %}
                    <button type="button" class="btn btn-default follow-button">
                        Follow
                    {% endif %}
                    </button>
                    {% if request.user in article.author.endorsed_by.all %}
                    <button type="button" class="btn btn-active btn-default endorse-button">
                        Endorsed
                    {% else %}
                    <button type="button" class="btn btn-default endorse-button">
                        Endorse
                    {% endif %}
                    <!-- <button type="button" class="btn btn-default">Feedback</button> -->
                </div>
                {% else %}
                <div class="post-tools">
                    <p class="article-post-meta"><img src="{{article.author.user.profile.picture.url}}" alt="author pic"/><a href="{% url 'newshub:profile' article.author.user.pk %}">{{article.author.user.first_name}} {{article.author.user.last_name}}</a></p>
                    <a href="{% url 'newshub:edit_article' article.pk %}" class="btn btn-default">Edit article</a>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div><!-- /.feed-main -->

    <div class="col-sm-2 right-feed-sidebar">
        {% include 'newshub/framework/right-feed-sidebar.html' %}
    </div><!-- /.right-sidebar -->
</div><!-- /.row -->

{%endblock%}